import pandas as pdimport numpy as npimport matplotlib.pyplot as pltimport tushare as tsimport talib# Get stock information by get_k_datastockreview = ts.get_k_data('601985', start='2015-01-01', end='2018-05-11')print(stockreview.shape)# Calculate ATR (average true rang) and add ATR to stockreview'''# tablib.ATR exampleatr10 = talib.ATR(stockreview.high.values, stockreview.low.values, stockreview.close.values, timeperiod=10)atr14 = talib.ATR(stockreview.high.values, stockreview.low.values, stockreview.close.values, timeperiod=14)atr21 = talib.ATR(stockreview.high.values, stockreview.low.values, stockreview.close.values, timeperiod=21)pd.DataFrame({'close': stockreview.close, 'atr5':atr5, 'atr10':atr10, 'atr14': atr14, 'atr21':atr21}).plot(subplots=True, grid=True)pd.DataFrame({'close': stockreview.close, 'atr5': atr5}).plot(subplots=True, grid=True)plt.show()'''atr5 = talib.ATR(stockreview.high.values, stockreview.low.values, stockreview.close.values, timeperiod=5)stockreview['atr5'] = atr5# Calculate MACD and add MACD bar to stockreviewstock_index = stockreview.indexdif, dea, bar = talib.MACD(stockreview.close.values,                           fastperiod=12,                           slowperiod=26,                           signalperiod=9)stockreview['MACD-bar']=barprint(stockreview)'''# Display MACD plt.plot(stock_index, dif,label='macd dif')plt.plot(stock_index, dea, label='signal dea')bar_red = np.where(bar > 0, bar, 0)bar_green= np.where(bar < 0, bar, 0)plt.bar(stock_index, bar_red, facecolor='red', label='hist bar')plt.bar(stock_index, bar_green, facecolor='green', label='hist bar')plt.legend(loc='best')plt.show()'''